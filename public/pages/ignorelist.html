<div class="container px-6 mx-auto grid">
  <div class="mb-4 text-lg font-semibold text-gray-600 dark:text-gray-300"></div>
  <div class="grid gap-6 mb-8 md:grid-cols-1">
    <!-- Ignore List Card -->
    <div class="flex items-start p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
      <div class="w-full">
        <h2 class="mb-4 text-2xl font-semibold text-gray-600 dark:text-gray-300">
          Ignore List
        </h2>

        <!-- Add Player Section -->
        <div class="mb-6">
          <label class="block text-sm mb-2">
            <span class="text-gray-600 dark:text-gray-300">Add Player to Ignore List</span>
          </label>
          <div class="flex gap-2">
            <input
              id="ignorePlayerInput"
              type="text"
              class="flex-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none dark:text-gray-300 form-input rounded-md"
              placeholder="Enter player name..."
            />
            <button
              id="addIgnoreBtn"
              class="px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 focus:outline-none"
            >
              Add
            </button>
          </div>
        </div>

        <!-- Ignored Players List -->
        <div>
          <h3 class="mb-3 text-lg font-semibold text-gray-600 dark:text-gray-300">
            Ignored Players (<span id="ignoreCount">0</span>)
          </h3>
          <div id="ignoreListContainer" class="space-y-2"></div>
          <div id="emptyMessage" class="text-sm text-gray-500 dark:text-gray-300 italic">
            No players ignored yet.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  (function initIgnorelistPage() {
    // Use global settingsSync from index.html
    const settingsSync = window.settingsSync;
    function loadIgnoreList() {
      const ignoreList = settingsSync.getJSON('ignoreList', []);
      const container = document.getElementById('ignoreListContainer');
      const emptyMessage = document.getElementById('emptyMessage');
      const countSpan = document.getElementById('ignoreCount');

      if (!container || !emptyMessage || !countSpan) return;

      countSpan.textContent = ignoreList.length;

      if (ignoreList.length === 0) {
        container.innerHTML = '';
        emptyMessage.style.display = 'block';
        return;
      }

      emptyMessage.style.display = 'none';
      container.innerHTML = ignoreList.map(player => `
        <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-md">
          <span class="text-gray-700 dark:text-gray-300">${player}</span>
          <button
            data-player="${player}"
            class="remove-player-btn px-3 py-1 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none"
          >
            Remove
          </button>
        </div>
      `).join('');

      // Add event listeners to remove buttons
      container.querySelectorAll('.remove-player-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const playerName = btn.getAttribute('data-player');
          const list = settingsSync.getJSON('ignoreList', []);
          const filtered = list.filter(p => p !== playerName);
          settingsSync.setJSON('ignoreList', filtered);
          loadIgnoreList();
        });
      });
    }

    // Add player to ignore list
    const addBtn = document.getElementById('addIgnoreBtn');
    const input = document.getElementById('ignorePlayerInput');

    if (addBtn && input) {
      addBtn.addEventListener('click', () => {
        const playerName = input.value.trim();
        if (!playerName) return;

        const ignoreList = settingsSync.getJSON('ignoreList', []);
        if (!ignoreList.includes(playerName)) {
          ignoreList.push(playerName);
          settingsSync.setJSON('ignoreList', ignoreList);
          input.value = '';
          loadIgnoreList();
        }
      });

      input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') addBtn.click();
      });
    }

    // Initial load
    loadIgnoreList();
  })();
</script>
