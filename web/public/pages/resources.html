<div class="container px-6 mx-auto grid">
	<div class="grid gap-6 mb-8 md:grid-cols-1 xl:grid-cols-1">
		<!-- Static Resources Section -->
		<div class="mt-4 flex items-start p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
			<div class="w-full">
				<h2 id="static-text" class="text-4xl font-semibold text-gray-600 dark:text-gray-300">
					ğŸª¨ Static Resources
				</h2>
			</div>
		</div>

	<!-- Static Resources Grids (generated dynamically) -->
	<div id="static-fiber-grid"></div>
	<div id="static-hide-grid"></div>
	<div id="static-wood-grid"></div>
	<div id="static-ore-grid"></div>
	<div id="static-rock-grid"></div>


		<!-- Living Resources Section -->
		<div class="mt-8 flex items-start p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
			<div class="w-full">
				<h2 id="living-gotext" class="text-4xl font-semibold text-gray-600 dark:text-gray-300">
					ğŸŒ¿ Living Resources
				</h2>
			</div>
		</div>

	<!-- Living Resources Grids (generated dynamically) -->
	<div id="living-fiber-grid"></div>
	<div id="living-hide-grid"></div>
	<div id="living-wood-grid"></div>
	<div id="living-ore-grid"></div>
	<div id="living-rock-grid"></div>


		<!-- Other Resources Section -->
		<div class="mt-8 flex items-start p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
			<div class="w-full">
				<h2 id="other-text" class="text-4xl font-semibold text-gray-600 dark:text-gray-300">
					âš™ï¸ Other
				</h2>
			</div>
		</div>

		<div class="flex items-start p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
			<div class="w-full">
				<label class="flex items-center space-x-2">
					<input type="checkbox" id="settingFishing" class="h-5 w-5 text-indigo-600 border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
					<span id="fishing-text" class="text-gray-600 dark:text-gray-300">ğŸ£ Show fishing pool</span>
				</label>
			</div>
		</div>

		<!-- Visual & Tools Section -->
		<div class="mt-8 flex items-start p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
			<div class="w-full">
				<h2 id="debug-text" class="text-4xl font-semibold text-gray-600 dark:text-gray-300">
					ğŸ¨ Visual & Tools
				</h2>
			</div>
		</div>

		<div class="flex items-start p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
			<div class="w-full">
				<div class="space-y-3">
					<label class="flex items-center space-x-2">
						<input type="checkbox" id="settingRawSize" class="h-5 w-5 text-indigo-600 border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
						<span id="size-text" class="text-gray-600 dark:text-gray-300">ğŸ“ Show Size</span>
					</label>

					<!-- Distance & Cluster Features -->
					<label class="flex items-center space-x-2">
						<input type="checkbox" id="settingResourceDistance" class="h-5 w-5 text-indigo-600 border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
						<span id="distance-text" class="text-gray-600 dark:text-gray-300">ğŸ“ Show Distance</span>
					</label>

					<label class="flex items-center space-x-2">
						<input type="checkbox" id="settingResourceClusters" class="h-5 w-5 text-indigo-600 border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
						<span id="cluster-text" class="text-gray-600 dark:text-gray-300">ğŸ—‚ï¸ Show Clusters</span>
					</label>

					<div class="ml-7 space-y-3">
						<label class="block text-sm">
							<span class="text-gray-600 dark:text-gray-300 text-xs">Cluster radius (meters)</span>
							<input
								id="settingClusterRadius"
								type="number"
								min="10"
								max="100"
								step="5"
								class="block w-24 mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none dark:text-gray-300 form-input rounded-md"
								placeholder="30"
							/>
						</label>
						<label class="block text-sm">
							<span class="text-gray-600 dark:text-gray-300 text-xs">Min resources per cluster</span>
							<input
								id="settingClusterMinSize"
								type="number"
								min="2"
								max="10"
								step="1"
								class="block w-24 mt-1 text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none dark:text-gray-300 form-input rounded-md"
								placeholder="2"
							/>
						</label>
					</div>

					<!-- Living Resources Display Options -->
					<label class="flex items-center space-x-2">
						<input type="checkbox" id="settingLivingResourcesHealthBar" class="h-5 w-5 text-indigo-600 border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
						<span class="text-gray-600 dark:text-gray-300">ğŸ“Š Show Health Bar</span>
					</label>

					<label class="flex items-center space-x-2">
						<input type="checkbox" id="settingLivingResourcesID" class="h-5 w-5 text-indigo-600 border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500">
						<span id="id-text" class="text-gray-600 dark:text-gray-300">ğŸ”– Show ID</span>
					</label>

					<hr class="my-4 border-gray-300 dark:border-gray-600">

					<p class="text-xs text-gray-500 dark:text-gray-300 mt-4">
						ğŸ’¡ <strong>Tip:</strong> Logging options in <a href="/settings" class="text-purple-600 dark:text-purple-300 hover:underline">Settings > Debug & Logging</a>
					</p>
				</div>
			</div>
		</div>

	</div>
</div>

<script>
    // Initialize immediately (SPA - page already loaded)
    (function initResourcesPage() {
    // Use globals from index.html
    const settingsSync = window.settingsSync;
    const {
        attachCheckboxListeners,
        generateResourceGrid,
        initializeTierButtonStates,
        updateTierButtonState,
        selectAllTierEnchants,
        getResourceStorageKey
    } = window.ResourcesHelper;

    // Make selectAllTierEnchants available globally for inline onclick handlers
    window.selectAllTierEnchants = selectAllTierEnchants;
	// Unified resource configuration
	const resources = [
		{ prefix: 'fsp', name: 'Fiber', emoji: 'ğŸŒ¿', type: 'Static', containerId: 'static-fiber-grid' },
		{ prefix: 'hsp', name: 'Hide', emoji: 'ğŸ¦Œ', type: 'Static', containerId: 'static-hide-grid' },
		{ prefix: 'wsp', name: 'Wood', emoji: 'ğŸªµ', type: 'Static', containerId: 'static-wood-grid' },
		{ prefix: 'osp', name: 'Ore', emoji: 'â›ï¸', type: 'Static', containerId: 'static-ore-grid' },
		{ prefix: 'rsp', name: 'Rock', emoji: 'ğŸª¨', type: 'Static', containerId: 'static-rock-grid' },
		{ prefix: 'flp', name: 'Dryad (Fiber)', emoji: 'ğŸŒ¿', type: 'Living', containerId: 'living-fiber-grid' },
		{ prefix: 'hlp', name: 'Animals (Hide)', emoji: 'ğŸ¦Œ', type: 'Living', containerId: 'living-hide-grid' },
		{ prefix: 'wlp', name: 'Spirit (Wood)', emoji: 'ğŸ‘»', type: 'Living', containerId: 'living-wood-grid' },
		{ prefix: 'olp', name: 'Elemental (Ore)', emoji: 'ğŸ”®', type: 'Living', containerId: 'living-ore-grid' },
		{ prefix: 'rlp', name: 'Elemental (Rock)', emoji: 'ğŸ’', type: 'Living', containerId: 'living-rock-grid' }
	];

	const enchantLevels = ['e0', 'e1', 'e2', 'e3', 'e4'];
	const defaultEnchants = {
		'e0': [false, false, false, false, false, false, false, false],
		'e1': [false, false, false, false, false, false, false, false],
		'e2': [false, false, false, false, false, false, false, false],
		'e3': [false, false, false, false, false, false, false, false],
		'e4': [false, false, false, false, false, false, false, false],
	};

	// STEP 1: Generate all resource grids
	resources.forEach(resource => {
		const container = document.getElementById(resource.containerId);
		if (container) {
			container.innerHTML = generateResourceGrid({
				prefix: resource.prefix,
				name: resource.name,
				emoji: resource.emoji
			});
		}
	});

	resources.forEach(config => {
		const storageKey = getResourceStorageKey(config.prefix, config.type);
		let enchants = settingsSync.getJSON(storageKey,defaultEnchants)

		enchantLevels.forEach(enchantLevel => {
			const parent = document.getElementById(`${config.prefix}-${enchantLevel}`);
			if (!parent) return;

			for (let i = 0; i < parent.children.length; i++) {
				const element = parent.children[i];
				const tierIndex = i;

				if (element.nodeName !== 'INPUT') continue;

				element.checked = enchants[enchantLevel][i];

				element.addEventListener("change", () => {
					enchants[enchantLevel][tierIndex] = element.checked;
					settingsSync.setJSON(storageKey, enchants);
					updateTierButtonState(config.prefix, tierIndex);
				});
			}
		});
	});
		
	//#region Other
	let settingFishing = document.getElementById("settingFishing");
	settingFishing.checked = settingsSync.getBool("settingFishing");
	settingFishing.addEventListener("click", () => {
		settingsSync.setBool("settingFishing", settingFishing.checked);
	});
	//#endregion

	//#region Debug
	let settingRawSize = document.getElementById("settingRawSize");
	settingRawSize.checked = settingsSync.getBool("settingRawSize");
	settingRawSize.addEventListener("click", () => {
		settingsSync.setBool("settingRawSize", settingRawSize.checked);
	});

	// ğŸ“ P0: New overlay features
	let settingResourceDistance = document.getElementById("settingResourceDistance");
	settingResourceDistance.checked = settingsSync.getBool("settingResourceDistance");
	settingResourceDistance.addEventListener("click", () => {
		settingsSync.setBool("settingResourceDistance", settingResourceDistance.checked);
	});

	let settingResourceClusters = document.getElementById("settingResourceClusters");
	settingResourceClusters.checked = settingsSync.getBool("settingResourceClusters");
	settingResourceClusters.addEventListener("click", () => {
		settingsSync.setBool("settingResourceClusters", settingResourceClusters.checked);
	});

	let settingClusterRadius = document.getElementById("settingClusterRadius");
	settingClusterRadius.value = settingsSync.getNumber("settingClusterRadius", 30);

	settingClusterRadius.addEventListener("input", () => {
		settingsSync.setNumber("settingClusterRadius",settingClusterRadius.value);
	});

	let settingClusterMinSize = document.getElementById("settingClusterMinSize");
	settingClusterMinSize.value = settingsSync.getNumber("settingClusterMinSize", 2);
	settingClusterMinSize.addEventListener("input", () => {
		settingsSync.setNumber("settingClusterMinSize",settingClusterMinSize.value);
	});

	let settingLivingResourcesHealthBar = document.getElementById("settingLivingResourcesHealthBar");
	settingLivingResourcesHealthBar.checked = settingsSync.getBool("settingLivingResourcesHealthBar");
	settingLivingResourcesHealthBar.addEventListener("click", () => {
		settingsSync.setBool("settingLivingResourcesHealthBar", settingLivingResourcesHealthBar.checked);
	});

	let settingLivingResourcesID = document.getElementById("settingLivingResourcesID");
	settingLivingResourcesID.checked = settingsSync.getBool("settingLivingResourcesID");
	settingLivingResourcesID.addEventListener("click", () => {
		settingsSync.setBool("settingLivingResourcesID", settingLivingResourcesID.checked);
	});
	//#endregion

	// Initialize tier button states and attach checkbox listeners after a small delay
	setTimeout(() => {
		attachCheckboxListeners();
		initializeTierButtonStates();
	}, 50); // Small delay to ensure grids are fully rendered

	})(); // Close initResourcesPage IIFE
</script>


